?((/* --------------------------------------------------------------------- ))
?((/* Programa MEALMOOR.LOG para construir la m quina de Moore equivalente  ))
?((/*                   a una m quina de Mealy dada.                        ))
?((/*   Realizado por: Rodolfo Gonz lez Gonz lez.                           ))
?((/* --------------------------------------------------------------------- ))

?((LOAD listas))

?((/* --------------------------------------------------------------------- ))

?((LOAD deltas))

?((/* --------------------------------------------------------------------- ))

((crea-estados2 (x1|x2) y z)
    (union ((x1 y)) () z1)
    (crea-estados2 x2 y z2)
    (union z1 z2 z)
)
((crea-estados2 () y ()))

((crea-estados1 x (y1|y2) z)
    (crea-estados2 x y1 z1)
    (crea-estados1 x y2 z2)
    (append z1 z2 z)
)
((crea-estados1 x () ()))

?((/* --------------------------------------------------------------------- ))

((MM2 (x1|x2) y)
    (car x1 y1)
    (cdr x1 y3)
    (car y3 y2)
    (delta y1 y z1)
    (lambda y1 y z2)
    (ADDCL ((delta-prima x1 y (z1 z2))))
    (MM2 x2 y)
)
((MM2 () y))

((MM1 x (y1|y2))
    (MM2 x y1)
    (MM1 x y2)
)
((MM1 x ()))

?((/* --------------------------------------------------------------------- ))

((LL1 (x1|x2))
    (cdr x1 y3)
    (car y3 y2)
    (ADDCL ((lambda-prima x1 y2)))
    (LL1 x2)
)
((LL1 ()))

?((/* --------------------------------------------------------------------- ))

((Mealy-Moore x)
    (Q x7)
    (Delta x5)
    (crea-estados1 x7 x5 z)
    (ADDCL ((Q-prima z)))
    (sigma x2)
    (MM1 z x2)
    (LL1 z)
    (Delta (x3|x4))
    (ADDCL ((Q0-prima (x x3))))
    (PP La maquina de Moore equivalente a la de Mealy dada es: )
    (PP Q prima es: z)
    (PP El alfabeto sigma es: x2)
    (PP El alfabeto Delta de salida es: x5)
    (PP delta prima, la tabla de transiciones, es: )
    (LIST delta-prima)
    (PP lambda prima es: )
    (LIST lambda-prima)
    (Q0-prima x6)
    (PP Estado inicial: x6)
)

?((/* --------------------------------------------------------------------- ))
?((/* x=estado inicial, z1z2=cadena a analizar                              ))
?((/* --------------------------------------------------------------------- ))

((Moore x (z1|z2))
    (delta-prima x z1 y)
    (lambda-prima y z22)
    (PP z22)
    (Moore y z2)
)
((Moore x ()))

((Moore-equiv y)
    (Q0-prima x)
    (Moore x y)
)